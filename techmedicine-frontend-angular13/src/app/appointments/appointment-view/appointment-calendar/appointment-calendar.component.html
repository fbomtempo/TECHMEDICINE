<div *ngIf="loadPage; else loadingError">
  <div class="row">
    <div class="col-lg-6 col-md-12 col-sm-12 pt-2 pb-3">
      <div class="pb-4">
        <div class="form-check form-switch">
          <input
            class="form-check-input"
            type="checkbox"
            role="switch"
            id="flexSwitchCheckDefault"
            [(ngModel)]="isChecked"
            (change)="showData()"
          />
          <label class="form-check-label" for="flexSwitchCheckDefault"
            >Mostrar Cancelados</label
          >
        </div>
      </div>
      <ng-select
        [items]="medics"
        (change)="setFilterMedic($event)"
        bindLabel="searchLabel"
        labelForId="medic"
        placeholder="Selecione o mÃ©dico"
        clearAllText="Limpar"
        [compareWith]="compareFnMedic"
        [loading]="medicsLoading"
        notFoundText="Nenhum item encontrado"
        [virtualScroll]="true"
      >
        <ng-template ng-label-tmp let-item="item">
          {{ item.name + " " + item.surname }}
        </ng-template>
        <ng-template
          ng-option-tmp
          let-item="item"
          let-index="index"
          let-search="searchTerm"
        >
          <div style="margin: 10px 0" class="card">
            <div class="card-body">
              <h5 class="card-title">{{ item.name + " " + item.surname }}</h5>
              <h6 class="card-subtitle mb-2 text-muted">CPF: {{ item.cpf }}</h6>
              <h6 class="card-subtitle mb-2 text-muted">
                Telefone: {{ item.mobilePhone }}
              </h6>
            </div>
          </div>
        </ng-template>
      </ng-select>
    </div>
  </div>
  <div>
    <full-calendar
      #calendar
      [options]="calendarOptions"
      class="mt-3 mb-5"
    ></full-calendar>
  </div>
</div>

<!-- MODAIS -->
<app-appointment-modal
  [appointment]="appointment"
  #appointmentModal
  (deletionEvent)="this.isChecked = false; this.loadPage = false; onRefresh()"
></app-appointment-modal>

<!-- TEMPLATES -->
<ng-template #loadingError>
  <div *ngIf="error | async; else loading">
    <div
      style="height: 80vh"
      class="d-flex flex-column align-items-center justify-content-center"
    >
      <p style="font-size: 1.65rem">Erro ao carregar agendamentos.</p>
      <button
        type="button"
        class="btn btn-lg btn-secondary"
        (click)="reloadPage()"
      >
        Tentar Novamente <i class="fas fa-sync-alt"></i>
      </button>
    </div>
  </div>
</ng-template>

<ng-template #loading>
  <div
    style="height: 80vh"
    class="d-flex align-items-center justify-content-center"
  >
    <div class="loader"></div>
  </div>
</ng-template>
